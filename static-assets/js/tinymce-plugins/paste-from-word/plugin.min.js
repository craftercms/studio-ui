!function(){"use strict";const e={isRegExp:e=>"[object RegExp]"===Object.prototype.toString.call(e),filter:(t,s)=>{for(let n=0;n<s.length;n++){const o=s[n];t=e.isRegExp(o)?t.replace(o,""):t.replace(o[0],o[1])}return t},isNewLineChar:e=>"\r"===e||"\n"===e,getForcedRootBlock:e=>{return e.getParam("forced_root_block")},getForcedRootBlockAttrs:e=>e.getParam("forced_root_block_attrs"),isCollapsibleWhitespace:e=>-1!==" \f\t\v".indexOf(e),getPasteWordValidElements:e=>e.getParam("paste_word_valid_elements")||"-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-h7,-h8,-pre,-p/div,-a[href|name],sub,sup,pre,blockquote,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody",getPostProcess:e=>e.getParam("paste_postprocess_ext")},t=(e,t,s)=>{const n=e.split(/\n\n/),o=((e,t)=>{const s=[];let n="<"+e;if("object"==typeof t){for(const e in t)Obj.has(t,e)&&s.push(e+'="'+tinymce.html.Entities.encodeAllRaw(t[e])+'"');s.length&&(n+=" "+s.join(" "))}return n+">"})(t,s),r="</"+t+">",l=Tools.map(n,e=>e.split(/\n/).join("<br />"));return 1===l.length?l[0]:l.map(e=>o+e+r).join("")},s=(e,t,s)=>{const n={},o=e.dom.parseStyle(s),r=Object.keys(o);for(let e=0;e<r.length;e++){let l=r[e];const a=o[l];switch(l){case"mso-list":const e=/\w+ \w+([0-9]+)/i.exec(s);e&&(t._listLevel=parseInt(e[1],10)),/Ignore/i.test(a)&&t.firstChild&&(t._listIgnore=!0,t.firstChild._listIgnore=!0);break;case"horiz-align":l="text-align";break;case"vert-align":l="vertical-align";break;case"font-color":case"mso-foreground":l="color";break;case"mso-background":case"mso-highlight":l="background";break;case"font-weight":case"font-style":"normal"!==a&&(n[l]=a);continue;case"mso-element":if(/^(comment|comment-list)$/i.test(a)){t.remove();continue}}0!==l.indexOf("mso-comment")?0!==l.indexOf("mso-")&&(n[l]=a):t.remove()}/(bold)/i.test(n["font-weight"])&&(delete n["font-weight"],t.wrap(new tinymce.html.Node("strong",1))),/(italic)/i.test(n["font-style"])&&(delete n["font-style"],t.wrap(new tinymce.html.Node("i",1)));const l=e.dom.serializeStyle(n,t.name);return l||null},n=(s,n)=>{const o=((e,s,n)=>s?t(e,!0===s?"p":s,n):(e=>e.replace(/\r?\n/g,"<br>"))(e))(((t,s)=>{const n=s.replace(/\t/g,"  ");return n.split().reduce((t,s)=>e.isCollapsibleWhitespace(s)||" "===s?t.pcIsSpace||""===t.str||t.str.length===n.length-1||isNewline(n,t.str.length+1)?{pcIsSpace:!1,str:t.str+" "}:{pcIsSpace:!0,str:t.str+" "}:{pcIsSpace:e.isNewLineChar(s),str:t.str+s},{pcIsSpace:!1,str:""}).str})(0,n.dom.encode(s["text/plain"]).replace(/\r\n/g,"\n")));n.execCommand("mceInsertContent",!1,o)},o=(t,n)=>{let o=t["text/html"];(e=>/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(e)||/class="OutlineElement/.test(e)||/id="?docs\-internal\-guid\-/.test(e))(o)&&(o=((t,n)=>{const o=[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,(e,t)=>t.length>0?t.replace(/./," ").slice(Math.floor(t.length/2)).split("").join(" "):""]];n=e.filter(n,o);const r=new tinymce.html.DomParser({},t.schema);r.addAttributeFilter("style",e=>{let n,o=e.length;for(;o--;)(n=e[o]).attr("style",s(t,n,n.attr("style"))),"span"===n.name&&n.parent&&!n.attributes.length&&n.unwrap()}),r.addAttributeFilter("class",e=>{let t,s,n=e.length;for(;n--;)s=(t=e[n]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(s)&&t.remove(),t.attr("class",null)}),r.addNodeFilter("del",e=>{let t=e.length;for(;t--;)e[t].remove()}),r.addNodeFilter("a",e=>{let t,s,n,o=e.length;for(;o--;)if(s=(t=e[o]).attr("href"),n=t.attr("name"),s&&-1!==s.indexOf("#_msocom_"))t.remove();else if(s&&0===s.indexOf("file://")&&(s=s.split("#")[1])&&(s="#"+s),s||n){if(n&&!/^_?(?:toc|edn|ftn)/i.test(n)){t.unwrap();continue}t.attr({href:s,name:n})}else t.unwrap()});const l=r.parse(n);return n=(new tinymce.html.Serializer).serialize(l)})(n,o)),o=((e,t)=>e.hasEventListeners("PluginPasteFromWordPostProcess")?((e,t)=>{const s=e.dom.create("div",{style:"display:none"},t);return((e,t)=>e.fire("PluginPasteFromWordPostProcess",{node:t}))(e,s).node.innerHTML})(e,t):t)(n,o=((t,s)=>{const n=e.getPasteWordValidElements(t),o=new tinymce.html.Schema({valid_elements:n,valid_children:"-li[p]"}),r=new tinymce.html.DomParser({},o);r.addAttributeFilter("style",e=>{let t,s=e.length;for(;s--;)(t=e[s]).attr("style",null)}),r.addAttributeFilter("class",e=>{let t,s=e.length;for(;s--;)(t=e[s]).attr("class",null)}),r.addNodeFilter("p",e=>{let t,s=e.length;for(;s--;){let n=(t=e[s]).firstChild,o=!0;for(;n;){if("br"!==n.name.toLowerCase()){o=!1;break}n=n.next}o&&t.unwrap()}});const l=r.parse(s);return s=(new tinymce.html.Serializer).serialize(l)})(n,o)),n.execCommand("mceInsertContent",!1,o)};tinymce.PluginManager.add("paste_from_word",function(t,s){let r=!1;t.ui.registry.addToggleButton("paste_as_text",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(e){r=!r,e.setActive(r),t.focus()},onSetup:function(e){t.on("PastePlainTextToggle",function(s){e.setActive(s.state),t.focus()})}}),t.ui.registry.addToggleMenuItem("paste_as_text",{text:"Paste as text",icon:"paste-text",tooltip:"Paste as text",onAction:function(e){r=!r,t.fire("PastePlainTextToggle",{state:r})},onSetup:function(e){return e.setActive(r),function(){}}}),t.on("paste",function(e){e.preventDefault();const s=((e,t)=>(e=>{const t={};if(e){if(e.getData){const s=e.getData("Text");s&&s.length>0&&-1===s.indexOf("data:text/mce-internal,")&&(t["text/plain"]=s)}if(e.types)for(let s=0;s<e.types.length;s++){const n=e.types[s];try{t[n]=e.getData(n)}catch(e){t[n]=""}}}return t})(t.clipboardData||e.getDoc().dataTransfer))(t,e),l=void 0!==s["text/html"];!r&&l?o(s,t):n(s,t)});const l=e.getPostProcess(t);l&&t.on("PluginPasteFromWordPostProcess",function(e){l.call(null,"paste_from_word",e)})})}();