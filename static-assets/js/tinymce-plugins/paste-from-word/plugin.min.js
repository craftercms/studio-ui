!function(){"use strict";const t={isRegExp:t=>"[object RegExp]"===Object.prototype.toString.call(t),filter:(e,n)=>{for(let s=0;s<n.length;s++){const o=n[s];e=t.isRegExp(o)?e.replace(o,""):e.replace(o[0],o[1])}return e},isNewLineChar:t=>"\r"===t||"\n"===t,getForcedRootBlock:t=>{return t.getParam("forced_root_block")},getForcedRootBlockAttrs:t=>{return t.getParam("forced_root_block_attrs")},isCollapsibleWhitespace:t=>-1!==" \f\t\v".indexOf(t)},e=(t,e,n)=>{const s=t.split(/\n\n/),o=((t,e)=>{const n=[];let s="<"+t;if("object"==typeof e){for(const t in e)Obj.has(e,t)&&n.push(t+'="'+tinymce.html.Entities.encodeAllRaw(e[t])+'"');n.length&&(s+=" "+n.join(" "))}return s+">"})(e,n),r="</"+e+">",l=Tools.map(s,t=>t.split(/\n/).join("<br />"));return 1===l.length?l[0]:l.map(t=>o+t+r).join("")},n=(t,e,n)=>{const s={},o=t.dom.parseStyle(n),r=Object.keys(o);for(let t=0;t<r.length;t++){let l=r[t];const i=o[l];switch(l){case"mso-list":const t=/\w+ \w+([0-9]+)/i.exec(n);t&&(e._listLevel=parseInt(t[1],10)),/Ignore/i.test(i)&&e.firstChild&&(e._listIgnore=!0,e.firstChild._listIgnore=!0);break;case"horiz-align":l="text-align";break;case"vert-align":l="vertical-align";break;case"font-color":case"mso-foreground":l="color";break;case"mso-background":case"mso-highlight":l="background";break;case"font-weight":case"font-style":"normal"!==i&&(s[l]=i);continue;case"mso-element":if(/^(comment|comment-list)$/i.test(i)){e.remove();continue}}0!==l.indexOf("mso-comment")?0!==l.indexOf("mso-")&&(s[l]=i):e.remove()}/(bold)/i.test(s["font-weight"])&&(delete s["font-weight"],e.wrap(new tinymce.html.Node("strong",1))),/(italic)/i.test(s["font-style"])&&(delete s["font-style"],e.wrap(new tinymce.html.Node("i",1)));const l=t.dom.serializeStyle(s,e.name);return l||null},s=(n,s)=>{const o=((t,n,s)=>n?e(t,!0===n?"p":n,s):(t=>t.replace(/\r?\n/g,"<br>"))(t))(((e,n)=>{const s=n.replace(/\t/g,"  ");return s.split().reduce((e,n)=>t.isCollapsibleWhitespace(n)||" "===n?e.pcIsSpace||""===e.str||e.str.length===s.length-1||isNewline(s,e.str.length+1)?{pcIsSpace:!1,str:e.str+" "}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:t.isNewLineChar(n),str:e.str+n},{pcIsSpace:!1,str:""}).str})(0,s.dom.encode(n["text/plain"]).replace(/\r\n/g,"\n")));s.execCommand("mceInsertContent",!1,o)},o=(e,s)=>{let o=e["text/html"];(t=>/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument/i.test(t)||/class="OutlineElement/.test(t)||/id="?docs\-internal\-guid\-/.test(t))(o)&&(o=((e,s)=>{const o=[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,(t,e)=>e.length>0?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join(" "):""]];s=t.filter(s,o);const r=new tinymce.html.DomParser({},e.schema);r.addAttributeFilter("style",t=>{let s,o=t.length;for(;o--;)(s=t[o]).attr("style",n(e,s,s.attr("style"))),"span"===s.name&&s.parent&&!s.attributes.length&&s.unwrap()}),r.addAttributeFilter("class",t=>{let e,n,s=t.length;for(;s--;)n=(e=t[s]).attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&e.remove(),e.attr("class",null)}),r.addNodeFilter("del",t=>{let e=t.length;for(;e--;)t[e].remove()}),r.addNodeFilter("a",t=>{let e,n,s,o=t.length;for(;o--;)if(n=(e=t[o]).attr("href"),s=e.attr("name"),n&&-1!==n.indexOf("#_msocom_"))e.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1])&&(n="#"+n),n||s){if(s&&!/^_?(?:toc|edn|ftn)/i.test(s)){e.unwrap();continue}e.attr({href:n,name:s})}else e.unwrap()});const l=r.parse(s);return s=(new tinymce.html.Serializer).serialize(l)})(s,o)),o=((t,e)=>{const n=t.settings.paste_word_valid_elements||"-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-h7,-h8,-pre,-p/div,-a[href|name],sub,sup,pre,blockquote,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody",s=new tinymce.html.Schema({valid_elements:n,valid_children:"-li[p]"}),o=new tinymce.html.DomParser({},s);o.addAttributeFilter("style",t=>{let e,n=t.length;for(;n--;)(e=t[n]).attr("style",null)}),o.addAttributeFilter("class",t=>{let e,n=t.length;for(;n--;)(e=t[n]).attr("class",null)}),o.addNodeFilter("p",t=>{let e,n=t.length;for(;n--;){let s=(e=t[n]).firstChild,o=!0;for(;s;){if("br"!==s.name.toLowerCase()){o=!1;break}s=s.next}o&&e.unwrap()}});const r=o.parse(e);return e=(new tinymce.html.Serializer).serialize(r)})(s,o),s.execCommand("mceInsertContent",!1,o)};tinymce.PluginManager.add("paste_from_word",function(t,e){let n=!1;t.ui.registry.addToggleButton("paste_as_text",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(e){n=!n,e.setActive(n),t.focus()},onSetup:function(e){t.on("PastePlainTextToggle",function(n){e.setActive(n.state),t.focus()})}}),t.ui.registry.addToggleMenuItem("paste_as_text",{text:"Paste as text",icon:"paste-text",tooltip:"Paste as text",onAction:function(e){n=!n,t.fire("PastePlainTextToggle",{state:n})},onSetup:function(t){return t.setActive(n),function(){}}}),t.on("paste",function(e){e.preventDefault();const r=((t,e)=>(t=>{const e={};if(t){if(t.getData){const n=t.getData("Text");n&&n.length>0&&-1===n.indexOf("data:text/mce-internal,")&&(e["text/plain"]=n)}if(t.types)for(let n=0;n<t.types.length;n++){const s=t.types[n];try{e[s]=t.getData(s)}catch(t){e[s]=""}}}return e})(e.clipboardData||t.getDoc().dataTransfer))(t,e),l=void 0!==r["text/html"];!n&&l?o(r,t):s(r,t)})})}();